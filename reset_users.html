<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Users - QHSE System</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; }
        .card { background: white; padding: 20px; margin: 20px 0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .header { background: #dc3545; color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        button { padding: 10px 20px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .status { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .status.success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .status.warning { background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö†Ô∏è Benutzer zur√ºcksetzen</h1>
            <p>Dieser Reset erstellt neue Benutzer mit vollst√§ndigen Profildaten</p>
        </div>

        <div class="card">
            <h2>üîÑ Benutzer-Reset</h2>
            <p>Diese Aktion wird:</p>
            <ul>
                <li>Alle bestehenden Benutzer l√∂schen</li>
                <li>Neue Benutzer mit erweiterten Profildaten erstellen</li>
                <li>Vollst√§ndige Qualifikationen und Sichtbarkeitseinstellungen hinzuf√ºgen</li>
                <li>Das Profilsystem komplett neu initialisieren</li>
            </ul>
            
            <div id="status"></div>
            
            <button onclick="resetUsers()" class="btn-danger">üóëÔ∏è Benutzer zur√ºcksetzen</button>
            <button onclick="checkUsers()" class="btn-primary">üë• Benutzer pr√ºfen</button>
            <button onclick="window.open('index.html', '_blank')" class="btn-success">üöÄ Hauptanwendung √∂ffnen</button>
        </div>

        <div class="card">
            <h2>üìã Neue Benutzer</h2>
            <p>Nach dem Reset werden folgende Benutzer mit vollst√§ndigen Profilen erstellt:</p>
            <ul>
                <li><strong>System Administrator</strong> - Vollzugriff, IT-Zertifizierung</li>
                <li><strong>Peter M√ºller (Betriebsleiter)</strong> - Erweiterte Qualifikationen, vollst√§ndige Kontaktdaten</li>
                <li><strong>Sarah Weber (QHSE)</strong> - QHSE-spezifische Zertifizierungen</li>
                <li><strong>Maria Santos (Mitarbeiter)</strong> - Grundqualifikationen</li>
                <li><strong>Klaus Fischer (Techniker)</strong> - Technische Zertifizierungen</li>
                <li>+ weitere Rollen mit spezifischen Profilen</li>
            </ul>
        </div>
    </div>

    <script>
        function showStatus(message, type = 'success') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function resetUsers() {
            if (!confirm('‚ö†Ô∏è WARNUNG: Alle bestehenden Benutzer werden gel√∂scht und neu erstellt. Fortfahren?')) {
                return;
            }

            try {
                // Clear existing users and related data
                localStorage.removeItem('qhse_users');
                localStorage.removeItem('qhse_current_user');
                
                showStatus('‚úÖ Benutzer wurden zur√ºckgesetzt. Die Hauptanwendung wird neue Benutzer mit vollst√§ndigen Profilen erstellen.', 'success');
                
                setTimeout(() => {
                    showStatus('üîÑ Automatisches Neuladen der Hauptanwendung...', 'warning');
                    // Auto-open main application
                    window.open('index.html', '_blank');
                }, 2000);
                
            } catch (error) {
                showStatus('‚ùå Fehler beim Zur√ºcksetzen: ' + error.message, 'warning');
            }
        }

        function checkUsers() {
            try {
                const users = JSON.parse(localStorage.getItem('qhse_users') || '[]');
                
                if (users.length === 0) {
                    showStatus('‚ÑπÔ∏è Keine Benutzer gefunden. √ñffnen Sie die Hauptanwendung, um Benutzer zu erstellen.', 'warning');
                    return;
                }

                let statusText = `üë• ${users.length} Benutzer gefunden:<br><br>`;
                users.forEach(user => {
                    const hasExtendedProfile = user.mobile || user.position || user.qualifications;
                    const profileStatus = hasExtendedProfile ? '‚úÖ Erweitert' : '‚ö†Ô∏è Basic';
                    statusText += `‚Ä¢ <strong>${user.displayName}</strong> (${user.role}) - ${profileStatus}<br>`;
                });

                showStatus(statusText, 'success');
                
            } catch (error) {
                showStatus('‚ùå Fehler beim Pr√ºfen: ' + error.message, 'warning');
            }
        }

        // Auto-check users on load
        window.onload = checkUsers;
    </script>
</body>
</html>