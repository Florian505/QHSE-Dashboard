<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test: Alle QHSE-Bereiche</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 3px;
            font-size: 12px;
        }
        .btn:hover { background: #2563eb; }
        .btn-secondary {
            background: #6b7280;
        }
        .btn-secondary:hover {
            background: #4b5563;
        }
        .btn-sm {
            padding: 4px 8px;
            font-size: 11px;
        }
        
        /* QHSE Notes Sections */
        .qhse-notes-section {
            margin-top: 1rem;
            padding: 1rem;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 8px;
            border: 2px solid #e2e8f0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        .notes-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e2e8f0;
        }
        .notes-header h3 {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
            margin: 0;
        }
        .notes-display {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.75rem;
            min-height: 60px;
            font-size: 13px;
            color: #374151;
            line-height: 1.5;
        }
        .notes-display p {
            margin: 0;
            color: #9ca3af;
            font-style: italic;
        }
        .notes-editor {
            margin-top: 8px;
        }
        .notes-editor textarea {
            width: 100%;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 0.75rem;
            font-size: 13px;
            font-family: inherit;
            resize: vertical;
            background: white;
            box-sizing: border-box;
            min-height: 80px;
        }
        .editor-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            justify-content: flex-end;
        }
        .success { color: #16a34a; font-weight: bold; }
        .error { color: #dc2626; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test: Alle QHSE-Bereiche</h1>
        <p>Diese Seite testet alle neuen QHSE-Freitext-Bereiche isoliert.</p>
        
        <button onclick="clearAllTestData()" class="btn btn-secondary">üóëÔ∏è Alle Test-Daten l√∂schen</button>
        <button onclick="showStoredData()" class="btn">üìä Gespeicherte Daten anzeigen</button>
        
        <div id="status"></div>
        
        <!-- Test 1: Arbeitsschutz -->
        <div class="test-section">
            <h2>1. Arbeitsschutz</h2>
            <div class="qhse-notes-section">
                <div class="notes-header">
                    <h3>üìù QHSE-Bereich: Arbeitsschutz Notizen</h3>
                    <button onclick="editNotes('arbeitsschutz')" class="btn btn-secondary btn-sm">‚úèÔ∏è Bearbeiten</button>
                </div>
                <div class="notes-content">
                    <div id="arbeitsschutzNotesDisplay" class="notes-display">
                        <p>Klicken Sie auf "Bearbeiten", um QHSE-spezifische Informationen f√ºr den Arbeitsschutz-Bereich hinzuzuf√ºgen.</p>
                    </div>
                    <div id="arbeitsschutzNotesEditor" class="notes-editor" style="display: none;">
                        <textarea id="arbeitsschutzNotesText" rows="4" placeholder="QHSE-Notizen, Ma√ünahmen, Beobachtungen..."></textarea>
                        <div class="editor-actions">
                            <button onclick="saveNotes('arbeitsschutz')" class="btn btn-sm">üíæ Speichern</button>
                            <button onclick="cancelNotes('arbeitsschutz')" class="btn btn-secondary btn-sm">‚ùå Abbrechen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test 2: Qualit√§t -->
        <div class="test-section">
            <h2>2. Qualit√§t</h2>
            <div class="qhse-notes-section">
                <div class="notes-header">
                    <h3>üìù QHSE-Bereich: Qualit√§ts-Notizen</h3>
                    <button onclick="editNotes('qualitaet')" class="btn btn-secondary btn-sm">‚úèÔ∏è Bearbeiten</button>
                </div>
                <div class="notes-content">
                    <div id="qualitaetNotesDisplay" class="notes-display">
                        <p>Klicken Sie auf "Bearbeiten", um QHSE-spezifische Informationen f√ºr den Qualit√§ts-Bereich hinzuzuf√ºgen.</p>
                    </div>
                    <div id="qualitaetNotesEditor" class="notes-editor" style="display: none;">
                        <textarea id="qualitaetNotesText" rows="4" placeholder="QHSE-Notizen zu Qualit√§tsprozessen..."></textarea>
                        <div class="editor-actions">
                            <button onclick="saveNotes('qualitaet')" class="btn btn-sm">üíæ Speichern</button>
                            <button onclick="cancelNotes('qualitaet')" class="btn btn-secondary btn-sm">‚ùå Abbrechen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test 3: Arbeitsanweisungen -->
        <div class="test-section">
            <h2>3. Arbeitsanweisungen ‚≠ê NEU</h2>
            <div class="qhse-notes-section">
                <div class="notes-header">
                    <h3>üìù QHSE-Bereich: Arbeitsanweisungen Notizen</h3>
                    <button onclick="editNotes('arbeitsanweisungen')" class="btn btn-secondary btn-sm">‚úèÔ∏è Bearbeiten</button>
                </div>
                <div class="notes-content">
                    <div id="arbeitsanweisungenNotesDisplay" class="notes-display">
                        <p>Klicken Sie auf "Bearbeiten", um QHSE-spezifische Informationen f√ºr Arbeitsanweisungen hinzuzuf√ºgen.</p>
                    </div>
                    <div id="arbeitsanweisungenNotesEditor" class="notes-editor" style="display: none;">
                        <textarea id="arbeitsanweisungenNotesText" rows="4" placeholder="QHSE-Notizen zu Arbeitsanweisungen, Schulungsstand, Aktualisierungsbedarf..."></textarea>
                        <div class="editor-actions">
                            <button onclick="saveNotes('arbeitsanweisungen')" class="btn btn-sm">üíæ Speichern</button>
                            <button onclick="cancelNotes('arbeitsanweisungen')" class="btn btn-secondary btn-sm">‚ùå Abbrechen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test 4: Verfahrensanweisungen -->
        <div class="test-section">
            <h2>4. Verfahrensanweisungen ‚≠ê NEU</h2>
            <div class="qhse-notes-section">
                <div class="notes-header">
                    <h3>üìù QHSE-Bereich: Verfahrensanweisungen Notizen</h3>
                    <button onclick="editNotes('verfahrensanweisungen')" class="btn btn-secondary btn-sm">‚úèÔ∏è Bearbeiten</button>
                </div>
                <div class="notes-content">
                    <div id="verfahrensanweisungenNotesDisplay" class="notes-display">
                        <p>Klicken Sie auf "Bearbeiten", um QHSE-spezifische Informationen f√ºr Verfahrensanweisungen hinzuzuf√ºgen.</p>
                    </div>
                    <div id="verfahrensanweisungenNotesEditor" class="notes-editor" style="display: none;">
                        <textarea id="verfahrensanweisungenNotesText" rows="4" placeholder="QHSE-Notizen zu Verfahrensanweisungen, Prozessoptimierungen, Auditfeststellungen..."></textarea>
                        <div class="editor-actions">
                            <button onclick="saveNotes('verfahrensanweisungen')" class="btn btn-sm">üíæ Speichern</button>
                            <button onclick="cancelNotes('verfahrensanweisungen')" class="btn btn-secondary btn-sm">‚ùå Abbrechen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test 5: Umwelt -->
        <div class="test-section">
            <h2>5. Umwelt</h2>
            <div class="qhse-notes-section">
                <div class="notes-header">
                    <h3>üìù QHSE-Bereich: Umwelt-Notizen</h3>
                    <button onclick="editNotes('umwelt')" class="btn btn-secondary btn-sm">‚úèÔ∏è Bearbeiten</button>
                </div>
                <div class="notes-content">
                    <div id="umweltNotesDisplay" class="notes-display">
                        <p>Klicken Sie auf "Bearbeiten", um QHSE-spezifische Informationen f√ºr den Umwelt-Bereich hinzuzuf√ºgen.</p>
                    </div>
                    <div id="umweltNotesEditor" class="notes-editor" style="display: none;">
                        <textarea id="umweltNotesText" rows="4" placeholder="QHSE-Notizen zu Umweltaspekten..."></textarea>
                        <div class="editor-actions">
                            <button onclick="saveNotes('umwelt')" class="btn btn-sm">üíæ Speichern</button>
                            <button onclick="cancelNotes('umwelt')" class="btn btn-secondary btn-sm">‚ùå Abbrechen</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Debug Info -->
        <div class="test-section">
            <h3>üîß Test-Ergebnisse</h3>
            <div id="results" style="margin-top: 15px; background: #f0f0f0; padding: 15px; border-radius: 4px; font-family: monospace; font-size: 12px; white-space: pre-wrap;"></div>
        </div>
    </div>

    <script>
        // Test-Implementation
        function editNotes(category) {
            console.log(`Edit ${category} notes`);
            const display = document.getElementById(`${category}NotesDisplay`);
            const editor = document.getElementById(`${category}NotesEditor`);
            
            if (display && editor) {
                display.style.display = 'none';
                editor.style.display = 'block';
                
                // Load existing content
                const saved = localStorage.getItem(`test_qhse_notes_${category}`);
                const textarea = document.getElementById(`${category}NotesText`);
                if (textarea && saved) {
                    textarea.value = saved;
                }
                textarea.focus();
                
                showStatus(`‚úèÔ∏è Editor f√ºr ${category} ge√∂ffnet`, 'success');
            }
        }

        function saveNotes(category) {
            console.log(`Save ${category} notes`);
            const textarea = document.getElementById(`${category}NotesText`);
            const display = document.getElementById(`${category}NotesDisplay`);
            const editor = document.getElementById(`${category}NotesEditor`);
            
            if (textarea && display && editor) {
                const content = textarea.value.trim();
                
                // Save to localStorage
                localStorage.setItem(`test_qhse_notes_${category}`, content);
                
                // Update display
                if (content) {
                    display.innerHTML = `<div style="white-space: pre-wrap; color: #374151;">${content}</div>`;
                } else {
                    display.innerHTML = `<p>Klicken Sie auf "Bearbeiten", um QHSE-spezifische Informationen f√ºr den ${category}-Bereich hinzuzuf√ºgen.</p>`;
                }
                
                // Switch back to display
                editor.style.display = 'none';
                display.style.display = 'block';
                
                showStatus(`üíæ ${category} Notizen gespeichert!`, 'success');
                updateResults();
            }
        }

        function cancelNotes(category) {
            console.log(`Cancel ${category} notes`);
            const display = document.getElementById(`${category}NotesDisplay`);
            const editor = document.getElementById(`${category}NotesEditor`);
            
            if (display && editor) {
                editor.style.display = 'none';
                display.style.display = 'block';
                showStatus(`‚ùå ${category} Bearbeitung abgebrochen`, 'error');
            }
        }

        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="${type}" style="margin: 10px 0; padding: 10px; border-radius: 4px; background: ${type === 'success' ? '#dcfce7' : type === 'error' ? '#fef2f2' : '#f0f9ff'};">${message}</div>`;
            setTimeout(() => {
                status.innerHTML = '';
            }, 3000);
        }

        function clearAllTestData() {
            if (confirm('Alle Test-Daten l√∂schen?')) {
                const categories = ['arbeitsschutz', 'qualitaet', 'umwelt', 'datenschutz', 'gesundheit', 'arbeitsanweisungen', 'verfahrensanweisungen'];
                categories.forEach(cat => {
                    localStorage.removeItem(`test_qhse_notes_${cat}`);
                });
                location.reload();
            }
        }

        function showStoredData() {
            updateResults();
        }

        function updateResults() {
            const results = document.getElementById('results');
            const categories = ['arbeitsschutz', 'qualitaet', 'umwelt', 'datenschutz', 'gesundheit', 'arbeitsanweisungen', 'verfahrensanweisungen'];
            
            let output = 'QHSE Notizen Test-Daten:\n\n';
            
            categories.forEach(cat => {
                const data = localStorage.getItem(`test_qhse_notes_${cat}`);
                output += `${cat}: ${data ? `"${data}"` : 'Nicht vorhanden'}\n`;
            });
            
            output += '\n--- LocalStorage Keys ---\n';
            const keys = Object.keys(localStorage).filter(k => k.startsWith('test_qhse_'));
            output += keys.length > 0 ? keys.join('\n') : 'Keine Test-Keys gefunden';
            
            results.textContent = output;
        }

        // Initialize
        window.onload = function() {
            console.log('QHSE Bereiche Test gestartet');
            updateResults();
        };
    </script>
</body>
</html>