<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <h1>QHSE Login System Debug</h1>
    <div id="debugResults"></div>
    
    <script>
        const debugResults = document.getElementById('debugResults');
        
        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.textContent = message;
            debugResults.appendChild(div);
        }
        
        // Test 1: Pr√ºfe ob alle Dateien geladen werden
        addResult('üîç Teste Login-System Komponenten...', 'warning');
        
        // Test Login-Styles
        const loginStylesLink = document.createElement('link');
        loginStylesLink.rel = 'stylesheet';
        loginStylesLink.href = 'login-styles.css';
        loginStylesLink.onload = () => addResult('‚úÖ login-styles.css erfolgreich geladen', 'success');
        loginStylesLink.onerror = () => addResult('‚ùå login-styles.css konnte nicht geladen werden', 'error');
        document.head.appendChild(loginStylesLink);
        
        // Test Login-Security Script
        const securityScript = document.createElement('script');
        securityScript.src = 'login-security.js';
        securityScript.onload = () => {
            addResult('‚úÖ login-security.js erfolgreich geladen', 'success');
            
            // Test ob QHSELoginSecurity verf√ºgbar ist
            setTimeout(() => {
                if (window.QHSELoginSecurity) {
                    addResult('‚úÖ QHSELoginSecurity Klasse verf√ºgbar', 'success');
                    if (window.qhseSecurity) {
                        addResult('‚úÖ qhseSecurity Instanz verf√ºgbar', 'success');
                    } else {
                        addResult('‚ùå qhseSecurity Instanz nicht verf√ºgbar', 'error');
                    }
                } else {
                    addResult('‚ùå QHSELoginSecurity Klasse nicht verf√ºgbar', 'error');
                }
            }, 100);
        };
        securityScript.onerror = () => addResult('‚ùå login-security.js konnte nicht geladen werden', 'error');
        document.body.appendChild(securityScript);
        
        // Test Login-App Script
        const appScript = document.createElement('script');
        appScript.src = 'login-app.js';
        appScript.onload = () => {
            addResult('‚úÖ login-app.js erfolgreich geladen', 'success');
            
            setTimeout(() => {
                if (window.QHSELoginApp) {
                    addResult('‚úÖ QHSELoginApp Klasse verf√ºgbar', 'success');
                    if (window.qhseLoginApp) {
                        addResult('‚úÖ qhseLoginApp Instanz verf√ºgbar', 'success');
                    } else {
                        addResult('‚ùå qhseLoginApp Instanz nicht verf√ºgbar', 'error');
                    }
                } else {
                    addResult('‚ùå QHSELoginApp Klasse nicht verf√ºgbar', 'error');
                }
            }, 100);
        };
        appScript.onerror = () => addResult('‚ùå login-app.js konnte nicht geladen werden', 'error');
        document.body.appendChild(appScript);
        
        // Test QHSE Script
        const qhseScript = document.createElement('script');
        qhseScript.src = 'script.js';
        qhseScript.onload = () => {
            addResult('‚úÖ script.js erfolgreich geladen', 'success');
            
            setTimeout(() => {
                if (window.QHSEDashboard) {
                    addResult('‚úÖ QHSEDashboard Klasse verf√ºgbar', 'success');
                } else {
                    addResult('‚ùå QHSEDashboard Klasse nicht verf√ºgbar', 'error');
                }
            }, 100);
        };
        qhseScript.onerror = () => addResult('‚ùå script.js konnte nicht geladen werden', 'error');
        document.body.appendChild(qhseScript);
        
        // Test LocalStorage
        try {
            localStorage.setItem('test', 'test');
            localStorage.removeItem('test');
            addResult('‚úÖ LocalStorage funktioniert', 'success');
        } catch (e) {
            addResult('‚ùå LocalStorage nicht verf√ºgbar: ' + e.message, 'error');
        }
        
        // Test Crypto API
        if (window.crypto && window.crypto.subtle) {
            addResult('‚úÖ Crypto API verf√ºgbar', 'success');
        } else {
            addResult('‚ùå Crypto API nicht verf√ºgbar (HTTPS erforderlich)', 'error');
        }
        
        // Test ob Login-Overlay existiert
        setTimeout(() => {
            const loginOverlay = document.getElementById('loginOverlay');
            if (loginOverlay) {
                addResult('‚úÖ Login-Overlay Element gefunden', 'success');
            } else {
                addResult('‚ùå Login-Overlay Element nicht gefunden', 'error');
            }
            
            // Test Session Check
            try {
                const sessionInfo = JSON.parse(localStorage.getItem('qhse_session_info') || '{}');
                addResult('‚ÑπÔ∏è Session Info: ' + JSON.stringify(sessionInfo), 'warning');
            } catch (e) {
                addResult('‚ÑπÔ∏è Keine Session-Info verf√ºgbar', 'warning');
            }
        }, 1000);
    </script>
</body>
</html>